<semantic-search
categories='{
  "<http://www.siriusplatform-risk-assessment/field/min_score>": [{
    "kind": "numeric-range",
    "datatype": "http://www.w3.org/2001/XMLSchema#double",
    "queryPattern": "{ 
      $subject ^cidoc:P31_has_modified ?event .
      ?event a cidoc:E5_Event ;
             cidoc:P39i_was_measured_by ?magnitude .
      ?magnitude a crmsci:S21_Measurement ;
                 cidoc:P2_has_type <https://w3id.org/sirius/type/magnitude-score> ;
                 cidoc:P40_observed_dimension ?dimension .
      ?dimension a cidoc:E54_Dimension ;
                 cidoc:P90_has_value ?literal .
      BIND(xsd:double(?literal) AS ?val)
      FILTER(?val >= xsd:double(?__numericRangeBeginValue__))
      FILTER(?val <= xsd:double(?__numericRangeEndValue__))
    }"
  }]}'

search-profile='{                   
  "categories": [
    {
      "iri":"<http://www.cidoc-crm.org/cidoc-crm/E39_Actor>",
      "label":"Concept",
      "thumbnail": "/assets/images/icons/rs-icons/user.svg"
    },  
    {
      "iri":"<http://www.cidoc-crm.org/cidoc-crm/E18_Physical_Thing>",
      "label":"Site",
      "thumbnail": "/assets/images/icons/rs-icons/places.svg"
    },
    {
      "iri":"<http://www.cidoc-crm.org/cidoc-crm/E89_Propositional_Object>",
      "label":"Agent",
      "thumbnail": "/assets/images/icons/rs-icons/places.svg"
    },
    {
      "iri":"<http://www.cidoc-crm.org/extensions/crmsci/S21_Measurement>",
      "label":"Magnitude Score",
      "thumbnail": "../images/fcs/things.svg"
    },
    {
      "iri":"<http://www.w3.org/2001/XMLSchema#Decimal>",
      "label":"Height",
      "thumbnail": "/assets/images/icons/rs-icons/height.svg"
    },
    {
      "iri":"<http://www.cidoc-crm.org/cidoc-crm/E5_Event>",
      "label":"Event",
      "thumbnail": "../images/fcs/things.svg"
    }
  ],
  
  "relations": [
    {
      "iri":"<http://www.siriusplatform-risk-assessment/field/agent_inverse>",
      "label":"Agent",
      "hasDomain":"<http://www.cidoc-crm.org/cidoc-crm/E18_Physical_Thing>",
      "hasRange":"<http://www.cidoc-crm.org/cidoc-crm/E39_Actor>"
    },
    {
      "iri":"<http://www.siriusplatform-risk-assessment/field/min_score>",
      "label":"Magnitude Range",
      "hasDomain":"<http://www.cidoc-crm.org/cidoc-crm/E18_Physical_Thing>",
      "hasRange":"<http://www.w3.org/2001/XMLSchema#Decimal>"
    }
  ]
}'

relations='{
  "<http://www.siriusplatform-risk-assessment/field/agent_inverse>": [{
    "kind": "resource",
    "queryPattern": "{ 
      $subject ^cidoc:P31_has_modified ?event .
      ?event a cidoc:E5_Event ;
             cidoc:P11_had_participant ?__value__ .
      ?__value__ a cidoc:E39_Actor .
    }"
  }],
  
  "<http://www.siriusplatform-risk-assessment/field/min_score>": [{
    "kind": "numeric-range",
    "datatype": "http://www.w3.org/2001/XMLSchema#double",
    "queryPattern": "{
      $subject ^cidoc:P31_has_modified ?event .
      ?event a cidoc:E5_Event ;
             cidoc:P39i_was_measured_by ?magnitude .
      ?magnitude a crmsci:S21_Measurement ;
                 cidoc:P2_has_type <https://w3id.org/sirius/type/magnitude-score> ;
                 cidoc:P40_observed_dimension ?dimension .
      ?dimension a cidoc:E54_Dimension ;
                 cidoc:P90_has_value ?literal .
      BIND(xsd:double(?literal) AS ?val)
      FILTER(?val >= xsd:double(?__numericRangeBeginValue__))
      FILTER(?val <= xsd:double(?__numericRangeEndValue__))
    }"
  }]
}'>
  
  <semantic-search-query-keyword 
    domain='<http://www.cidoc-crm.org/cidoc-crm/E18_Physical_Thing>' 
    query='
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX cidoc: <http://www.cidoc-crm.org/cidoc-crm/>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      SELECT ?subject 
      WHERE {
        ?subject a cidoc:E18_Physical_Thing; 
                 cidoc:P1_is_identified_by ?name_identifier . 
        ?name_identifier a cidoc:E41_Appellation;
                         skos:prefLabel ?label.
        FILTER REGEX(STR(?label), ?__token__, "i") 
      } 
    ' 
    default-query='
      PREFIX cidoc: <http://www.cidoc-crm.org/cidoc-crm/>
      SELECT DISTINCT ?subject ?label 
      WHERE { 
        ?subject a cidoc:E18_Physical_Thing .
      }
    ' 
    debounce=500>
  </semantic-search-query-keyword>

  <div data-flex-layout="row stretch-stretch">
    <div data-flex-self="size-1of3" style="flex: 0 0 20px;">
      <semantic-search-facet value-relations='{
        "<http://www.siriusplatform-risk-assessment/field/min_score>": {
          "kind": "numeric-range",
          "valuesQuery": "
            PREFIX cidoc: <http://www.cidoc-crm.org/cidoc-crm/>
            PREFIX crmsci: <http://www.ics.forth.gr/isl/CRMsci/>
            PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
            SELECT (MIN(xsd:double(?val)) AS ?numericRangeBeginValue)
                   (MAX(xsd:double(?val)) AS ?numericRangeEndValue)
            WHERE {
              $subject ^cidoc:P31_has_modified ?event .
              ?event cidoc:P39i_was_measured_by ?magnitude .
              ?magnitude a crmsci:S21_Measurement ;
                         cidoc:P2_has_type <https://w3id.org/sirius/type/magnitude-score> ;
                         cidoc:P40_observed_dimension ?dimension .
              ?dimension cidoc:P90_has_value ?val .
            }"
        }
      }'></semantic-search-facet>
    </div>
